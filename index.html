<html>
  <head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.12"></script>
    <script src="./messagepipe.js"></script>
  </head>
  <script>
      window.pipe = new MessagePipe(window.parent, 'http://localhost:61493');
      pipe.send({
        message: 'new message from github.'
      });
      pipe.onConnected = function(data) {
        console.log('GitHub: pipe connected!');
      };      
      pipe.onReceived = function(data) {
        console.log('GitHub: recevied', data);
      };
      pipe.connect();
  </script>
  <body>
    <div id="app">
      <h1>Cutting Management MOCKUP</h1>
      <form>
        <div v-for="item in removalList">
          <div class="form-group">
            <label>rawSapMaterial</label>
            <input type="text" class="form-control" v-model="item.rawSapMaterial">
          </div>
          <div class="form-group">
            <label>lamWoodModuleLength</label>
            <input type="text" class="form-control" v-model="item.lamWoodModuleLength">
          </div>  
        </div>
        <button class="btn btn-primary" @click="add">+ Add item</button>
        <button class="btn btn-primary" @click="">Save</button>
        <button class="btn btn-secondary" @click="">Reset</button>
        <button class="btn btn-secondary" @click="">Cancel</button>
      </form>
    </div>
    <script>
      (function() {
        var pipe = new MessagePipe(window.parent, 'http://localhost:61493');
        pipe.onConnected = function(data) {
          console.log('MOCKUP: pipe connected!');
        };      
        pipe.onReceived = function(data) {
          console.log('GitHub: recevied', data);
        };
        pipe.connect();

        new Vue({
          data: {
            removalList: [
              {
                "rawSapMaterial": "test1",
                "lamWoodModuleLength": "test2"
              }
            ]
          },
          methods: {
            add: function() {
              this.removalList.push({
                "rawSapMaterial": "",
                "lamWoodModuleLength": ""
              });
            },          
            save: function() {
              pipe.send({
                method: "setRemovalList",
                params: [
                  {
                    removalList: this.removalList
                  }
                ]
              })
            },
            reset: function() {
              this.removalList = []
            },
            cancel: function () {
              pipe.send({
                method: "terminate"
              });
            }
          }
        })
      })()
    </script>
  </body>
</html>